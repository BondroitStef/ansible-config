server {
  listen 80;
  server_name .event.fkgent.be;

  return 301 https://$server_name$request_uri;
}

server {
  listen 443 ssl;
  server_name .event.fkgent.be;
  root /home/gandalf/production/current/public/;

  ####################
  # SSL OPTIONS
  ####################
  ssl_certificate ssl/wildcard_fkgent_be.pem;
  ssl_certificate_key ssl/wildcard_fkgent_be.key;
  ssl_session_timeout 5m;

  ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
  ssl_ciphers 'AES128+EECDH:AES128+EDH:!aNULL';
  ssl_prefer_server_ciphers on;
  ssl_session_cache shared:SSL:10m;

  ssl_stapling on;
  ssl_stapling_verify on;
  resolver 8.8.4.4 8.8.8.8 valid=300s;
  resolver_timeout 10s;

  location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
    expires 1y;
    add_header Cache-Control public;
  }

  send_timeout 300s;

  passenger_enabled on;

  access_log /home/gandalf/log/access.log;
  error_log /home/gandalf/log/error.log;
}
